{% include "base.html.twig"%}
<style>
.carousel-indicators li{
  background-color: #000000;
}
.border{
  border: 1px solid #dbe9e8;
}
p{
  text-align:justify;  
  text-justify:auto;
}
</style>
<div class="container-fluid" style="max-width:600px;">
  <div id="product_images" class="carousel slide border" data-ride="carousel" data-interval="false">
  </div>
  <form id="info_form" name="info_form">
    <div class="form-group">
      <input type="hidden" id="product_id" name="product_id" value="">
      <label for="product_name">Product name</label>
      <input type="text" class="form-control" id="product_name" name="product_name" placeholder="Product Name">
    </div>
    <div class="form-group">
      <label for="product_description">Product Description</label>
      <textarea class="form-control" id="product_description" name="product_description" placeholder="Product Description" rows="3"></textarea>
    </div>
    <div class="form-group">
      <label for="product_size">Product size</label>
      <input type="text" class="form-control" id="product_size" name="product_size" placeholder="Product Size">
    </div>
    <div class="form-group">
      <label for="product_price">Product price</label>
      <input type="text" class="form-control" id="product_price" name="product_price" placeholder="Product price">
    </div>
    <div class="form-group">
      <label for="product_availability">Availablity</label>
      <select class="form-control" id="product_availability" name="product_availability">
        <option value="1">Available</option>
        <option value="0">Out Of Stock</option>
      </select>
    </div>
  </form>
  <button type="submit" id="btnRegister" class="btn btn-primary">Register</button>
</div>
<script>
var logic = {
  init:function(){
    $("#product_images").on("slid.bs.carousel", function () {
      $holder = $("ol li.active");
      $holder.removeClass("active");
      var idx = $("div.active").index("div.carousel-item");
      $("ol.carousel-indicators li[data-slide-to='"+ idx+"']").addClass("active");
    });
    $("ol.carousel-indicators li").on("click",function(){ 
      $("ol.carousel-indicators li.active").removeClass("active");
      $(this).addClass("active");
    });
    $("#btnRegister").on("click",function(){ 
      logic.save();
    });
    logic.dataload();
  },
  dataload:function(){
    var urlParams = THO.getUrlParams();
    THO.GET("/api/ApiProductEdit", {code:urlParams.code}, function(text, data, xml) {
      var json = data.json();
      console.log(json);
      THO.createProductImages(json.images, "product_images");
      // THO.createProductInfo(json.info, "product_info");
      $("#product_id").val(json.info.product_id);
      $("#product_name").val(json.info.name);
      $("#product_description").val(json.info.description);
      $("#product_size").val(json.info.size);
      $("#product_price").val(json.info.price);
      $("#product_availability").val(json.info.product_availability);
    });
  },
  save:function(){
    var _formData = THO.getFormData("info_form");
    THO.POST("/api/ApiProductEdit/update", _formData, function(text, data, xml) {
      webix.message("Registered");
      logic.dataload();
    });
  }
};
webix.ready(function () {
  logic.init();
});
</script>
{% include "footer.html.twig"%}
